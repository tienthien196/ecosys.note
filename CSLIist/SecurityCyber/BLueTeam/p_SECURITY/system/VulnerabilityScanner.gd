# res://security360/system/VulnerabilityScanner.gd
class_name VulnerabilityScanner
extends SecurityModule

var logger = null

func _init():
    logger = preload("res://security360/core/Logger.gd").new()

func start():
    logger.info("üîç [VulnerabilityScanner] ƒêang qu√©t h·ªá th·ªëng...")
    scan_local_system()

func scan_local_system():
    # Gi·∫£ l·∫≠p qu√©t
    Security360.events.emit("VULNERABILITY_FOUND", {
        service: "Apache",
        version: "2.4.49",
        cve: "CVE-2023-1234",
        severity: "CRITICAL"
    })
    Security360.events.emit("VULNERABILITY_FOUND", {
        service: "SSH",
        port: 22,
        issue: "weak_ciphers",
        severity: "MEDIUM"
    })

func stop():
    logger.info("üõë [VulnerabilityScanner] ƒê√£ t·∫Øt.")